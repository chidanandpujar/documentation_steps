root@masterhost:~/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections# ansible-playbook -i inventory_junos pb.juniper_junos_command.yml 
[WARNING]: errors were encountered during the plugin load for junipernetworks.junos.junos_command: ["'NoneType' object has no attribute 'get'"]
ERROR! couldn't resolve module/action 'junipernetworks.junos.junos_command'. This often indicates a misspelling, missing collection, or incorrect module path.

The error appears to be in '/root/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections/pb.juniper_junos_command.yml': line 11, column 7, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

  tasks:
    - name: Run show version
      ^ here

root@masterhost:~/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections# cat juniper/device/meta/runtime.yml 
requires_ansible: ">=2.17.0"
plugin_routing:
  plugins:
  modules:
    hostname:
      redirect: juniper.device.junos_hostname
    interfaces:
      redirect: juniper.device.junos_interfaces
    acls:
      redirect: juniper.device.junos_acls
    acl_interfaces:
      redirect: juniper.device.junos_acl_interfaces
    banner:
      redirect: juniper.device.junos_banner
    bgp_address_family:
      redirect: juniper.device.junos_bgp_address_family
    bgp_global:
      redirect: juniper.device.junos_bgp_global



ln -fs junos.py junos_command.py

root@masterhost:~/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections/juniper/device/plugins/action# ln -fs junos.py junos_command.py
root@masterhost:~/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections/juniper/device/plugins/action# ls -lrt | grep command
lrwxrwxrwx 1 root root   30 Apr 28 21:12 command.py -> juniper_junos_common_action.py
lrwxrwxrwx 1 root root    8 May  6 22:32 junos_command.py -> junos.py


root@masterhost:~/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections# ansible-playbook -i inventory_junos pb.juniper_junos_command.yml 
[WARNING]: errors were encountered during the plugin load for junipernetworks.junos.junos_command: ["'NoneType' object has no attribute 'get'"]
ERROR! couldn't resolve module/action 'junipernetworks.junos.junos_command'. This often indicates a misspelling, missing collection, or incorrect module path.

The error appears to be in '/root/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections/pb.juniper_junos_command.yml': line 11, column 7, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

  tasks:
    - name: Run show version
      ^ here

root@masterhost:~/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections# cat juniper/device/meta/runtime.yml 
requires_ansible: ">=2.17.0"
plugin_routing:
  plugins:
  modules:
    hostname:
      redirect: juniper.device.junos_hostname
    interfaces:
      redirect: juniper.device.junos_interfaces
    acls:
      redirect: juniper.device.junos_acls
    acl_interfaces:
      redirect: juniper.device.junos_acl_interfaces
    banner:
      redirect: juniper.device.junos_banner
    bgp_address_family:
      redirect: juniper.device.junos_bgp_address_family
    bgp_global:
      redirect: juniper.device.junos_bgp_global


root@masterhost:~/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections# vi junipernetworks/junos/meta/runtime.yml

---
requires_ansible: ">=2.15.0"
plugin_routing:
  action:
    # junos_facts:
    #   redirect: juniper.device.junos_facts
    # junos_hostname:
    #   redirect: juniper.device.hostname
    # junos_acls:
    #   redirect: juniper.device.acls
    # junos_interfaces:
    #   redirect: juniper.device.interfaces
    # netconf:
    #   redirect: juniper.device.junos
  modules:
    acl_interfaces:
      redirect: juniper.device.junos_acl_interfaces
    junos_banner: #debug
      redirect: juniper.device.junos_banner
    junos_command: #debug
      redirect: juniper.device.junos_command

root@masterhost:~/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections/juniper/device/plugins/action# ln -fs junos.py junos_command.py
root@masterhost:~/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections/juniper/device/plugins/action# ls -lrt | grep command
lrwxrwxrwx 1 root root   30 Apr 28 21:12 command.py -> juniper_junos_common_action.py
lrwxrwxrwx 1 root root    8 May  6 22:32 junos_command.py -> junos.py




root@masterhost:~/ansible_modules_redirection_test5/ansible-junos-stdlib/ansible_collections# ansible-playbook -i inventory_junos pb.juniper_junos_command.yml 
[WARNING]: errors were encountered during the plugin load for junipernetworks.junos.junos_command: ["'NoneType' object has no attribute 'get'"]
[WARNING]: errors were encountered during the plugin load for assert: ["'NoneType' object has no attribute 'get'"]

PLAY [Functional Test - junos_command module] **************************************************************************************************

TASK [Run show version] ************************************************************************************************************************
[WARNING]: errors were encountered during the plugin load for junipernetworks.junos.junos: ["'NoneType' object has no attribute 'get'"]
ok: [10.220.10.59]

TASK [Assert show version output is returned] **************************************************************************************************
ok: [10.220.10.59] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [Run show version with wait_for condition (positive match)] *******************************************************************************
ok: [10.220.10.59]

TASK [Assert wait_for with positive match passed] **********************************************************************************************
ok: [10.220.10.59] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [Run multiple commands] *******************************************************************************************************************
ok: [10.220.10.59]

TASK [Assert multiple commands worked] *********************************************************************************************************
ok: [10.220.10.59] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [Run show version with json output] *******************************************************************************************************
ok: [10.220.10.59]

TASK [Assert json output is returned] **********************************************************************************************************
ok: [10.220.10.59] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [Run RPC get-software-information] ********************************************************************************************************
ok: [10.220.10.59]

TASK [Assert RPC output] ***********************************************************************************************************************
ok: [10.220.10.59] => {
    "changed": false,
    "msg": "All assertions passed"
}

PLAY RECAP *************************************************************************************************************************************
10.220.10.59               : ok=10   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
